apiVersion: "nuclio.io/v1"
kind: NuclioFunction

metadata:
  name: palatal-rugoscopy-annotator
  namespace: cvat

spec:
  desc: "A Mask R-CNN model trained for automatic annotations of palatal rugae on CVAT."
  runtime: "python:3.10"
  handler: main:handler
  eventTimeout: 30s
  
  build:
    image: cvat/ai-palatal-rugoscopy-annotator
    baseImage: ai-palatal-rugoscopy

    directives:
      preCopy:
        - kind: ENV
          value: DEBIAN_FRONTEND=noninteractive
        - kind: ENV
          value: PYTHONPATH=/opt/nuclio
        - kind: WORKDIR
          value: /opt/nuclio

  triggers:
    http:
      kind: http
      attributes:
        serviceType: NodePort
    periodic:
      attributes:
        interval: 3s
      class: ""
      kind: cron
